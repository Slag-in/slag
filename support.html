<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/support.css">
  <title>Support Slag</title>
  <!-- Standard favicon -->
  <link rel="icon" href="assets/favicon/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/svg+xml" href="assets/favicon/favicon.svg">
  <link rel="alternate icon" type="image/png" sizes="96x96" href="assets/favicon/favicon-96x96.png">

  <!-- Apple Touch Icon (iPhone/iPad) -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">

  <!-- Web App Manifest -->
  <link rel="manifest" href="assets/favicon/site.webmanifest">

  <!-- Android / PWA icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="assets/favicon/web-app-manifest-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="assets/favicon/web-app-manifest-512x512.png">

  <!-- Theme & tile colors -->
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">
</head>

<body>
  <!-- Navbar -->
  <header>
    <nav class="navbar-container">
      <div class="navbar">
        <div class="nav-left">
          <a href="/index.html">New Arrivals</a>
          <a href="/gallery.html">Gallery</a>
          <a href="/terms.html">Terms</a>
        </div>

        <div class="nav-logo">
          <span>Slag</span>
        </div>

        <div class="nav-right">
          <a href="/support.html">Support</a>
          <a href="/contact.html">Contact us</a>
          <a id="cartOpen" href="javascript:void(0)">Cart</a>
        </div>
      </div>

      <!-- Mobile Navbar Icons -->
      <div class="mobile-nav" id="mobileNav">
        <div class="menu-icon" id="menuToggle">
          <img src="assets/icons/menu-black.svg" alt="Menu" id="menuIcon">
        </div>

        <div class="nav-logo-mobile" id="navLogo">
          <img src="assets/icons/logo.svg" alt="">
        </div>

        <div class="cart-icon" id="cartIcon">
          <img src="assets/icons/cart-black.svg" alt="Cart" id="cartImg" href="javascript:void(0)">
        </div>
      </div>


      <!-- Mobile Slide Menu -->
      <div class="mobile-menu" id="mobileMenu">
        <a href="/index.html">New Arrivals</a>
        <a href="/gallery.html">Gallery</a>
        <a href="/terms.html">Terms</a>
        <a href="/support.html">Support</a>
        <a href="/contact.html">Contact us</a>
      </div>
    </nav>
  </header>

  <div class="headingContainer">
    <span class="heading1">Support Us!</span>
  </div>

  <div class="pcont">
    <div class="pcontainer">
      <p>At Slag, we are a small thrift startup from Kerala with a dream of building something that meets international
        standards while staying true to our roots. Every piece we curate and every detail we design is done with
        passion, creativity, and care — but growing a brand like this takes resources. If you believe in our vision of
        giving new life to thrifted fashion and making sustainable clothing accessible to everyone, we’d be truly
        grateful for your support. Your donation, no matter how small, helps us keep the dream alive — funding better
        production, packaging, and creative growth for our brand.</p>
    </div>

  </div>

  <div class="support-box">
    <div class="support-container">
      <div class="currency">₹</div>
      <input id="amountInput" type="number" value="1" min="1" placeholder="Enter amount">
      <button id="supportBtn">Support</button>
    </div>
    <div id="supportMessage"></div>
  </div>

  <!-- Cart Sidebar -->
  <div id="cartSidebar" class="cart-sidebar">
    <div class="cart-header">
      <h2>Your cart</h2>
      <span id="closeCart" class="close-cart">✕</span>
    </div>

    <div id="cartItems" class="cart-items"></div>

    <div class="cart-footer">
      <div id="cartTotal" class="cart-total">Total: ₹0</div>
      <button id="checkoutBtn" class="checkout-btn">Check out</button>
    </div>
  </div>


  <!-- QR Modal -->
  <div id="qrModal" class="qr-modal">
    <div class="qr-content">
      <span id="closeQr" class="close-btn">&times;</span>
      <div id="qrCode"></div>
    </div>
  </div>

  <footer>
    <div class="innerfooter">
      <div class="linkContainer">
        <a href="/contact.html">Contact Us</a>
        <a href="/support.html">Support</a>
        <a href="/terms.html">Terms</a>
      </div>
      <div class="linkContainer">
        <a href="mailto:slagproductionsofficial@gmail.com">Mail us</a>
        <a href="https://www.threads.net/slag.in">Threads</a>
        <a href="https://www.instagram.com/slag.in">Instagram</a>
      </div>
      <div class="logoContainer">
        <img src="assets/icons/logo.svg" alt="">
      </div>
    </div>
  </footer>

  <div class="copyright">© 2025 Slag.in</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const supportBtn = document.getElementById("supportBtn");
      const amountInput = document.getElementById("amountInput");
      const message = document.getElementById("supportMessage");

      const qrModal = document.getElementById("qrModal");
      const qrCodeContainer = document.getElementById("qrCode");
      const closeQr = document.getElementById("closeQr");

      supportBtn.addEventListener("click", function () {
        const amount = amountInput.value.trim();
        if (!amount || amount <= 0) {
          message.textContent = "Please enter a valid amount.";
          message.style.color = "red";
          return;
        }

        const upiId = "7736567531@okbizaxis"; // Replace with your UPI ID
        const name = "Slag";
        const note = "Support for Slag";

        const upiUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(
          name
        )}&am=${amount}&cu=INR&tn=${encodeURIComponent(note)}`;

        const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

        if (isMobile) {
          window.location.href = upiUrl;
          message.style.color = "#555";
        } else {

          // Generate QR code
          qrCodeContainer.innerHTML = ""; // Clear previous QR
          new QRCode(qrCodeContainer, {
            text: upiUrl,
            width: 200,
            height: 200,
            colorDark: "#000000",
            colorLight: "#ffffff",
          });

          // Show modal
          qrModal.style.visibility = "visible";
          qrModal.style.opacity = "100%";
        }
      });

      // Close modal when clicking the close button
      closeQr.addEventListener("click", function () {
        qrModal.style.visibility = "hidden";

      });

      // Close modal when clicking outside the QR content
      window.addEventListener("click", function (e) {
        if (e.target == qrModal) {
          qrModal.style.visibility = "hidden";
        }
      });
    });

    // --- CART SYSTEM ---

    // Add to Cart
    const addCartBtn = document.querySelector('.add-cart');
    if (addCartBtn) {
      const product = {
        title: document.querySelector('.product-title').innerText,
        price: parseInt(document.querySelector('.product-price').innerText.replace(/[^\d]/g, '')),
        image: document.getElementById('displayedImage').src
      };

      // Check if product already in cart and disable button if yes
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const alreadyInCart = cart.some(item => item.title === product.title);
      if (alreadyInCart) {
        disableAddToCartButton();
      }

      addCartBtn.addEventListener('click', () => {
        addToCart(product);
      });
    }

    function addToCart(product) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const existingItem = cart.find(item => item.title === product.title);

      // Only add if not already present
      if (!existingItem) {
        cart.push({ ...product, quantity: 1 });
        localStorage.setItem('cart', JSON.stringify(cart));

        // Disable button after adding
        disableAddToCartButton();

        // Open the cart automatically
        loadCart();
        const cartSidebar = document.getElementById('cartSidebar');
        if (cartSidebar) {
          cartSidebar.classList.add('open');
        }
      }
    }

    function disableAddToCartButton() {
      const addCartBtn = document.querySelector('.add-cart');
      addCartBtn.disabled = true;
      addCartBtn.style.backgroundColor = '#ccc';
      addCartBtn.style.cursor = 'not-allowed';
      addCartBtn.innerText = 'Added to Cart';
    }

    // --- CART SIDEBAR CONTROLS ---
    const cartSidebar = document.getElementById('cartSidebar');
    const cartOpen = document.getElementById('cartOpen');
    const closeCart = document.getElementById('closeCart');

    if (cartOpen) {
      cartOpen.addEventListener('click', () => {
        loadCart();
        cartSidebar.classList.add('open');
      });
    }

    if (closeCart) {
      closeCart.addEventListener('click', () => {
        cartSidebar.classList.remove('open');
      });
    }

    // Load cart items
    function loadCart() {
      const cartItemsContainer = document.getElementById('cartItems');
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cartItemsContainer.innerHTML = '';

      if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
        updateTotal();
        return;
      }

      cart.forEach((item, index) => {
        const div = document.createElement('div');
        div.classList.add('cart-item');
        div.innerHTML = `
      <button class="remove-btn" data-index="${index}">✕</button>
      <img src="${item.image}" alt="${item.title}">
      <div class="cart-item-info">
        <p>${item.title}</p>
        <p class="price">₹${item.price}</p>
      </div>
    `;
        cartItemsContainer.appendChild(div);
      });

      attachCartEvents();
      updateTotal();
    }

    function attachCartEvents() {
      document.querySelectorAll('.remove-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const index = e.target.dataset.index;
          removeItem(index);
        });
      });
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const removedItem = cart[index];
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      loadCart();

      // Re-enable Add to Cart if user removed it
      const productTitle = document.querySelector('.product-title')?.innerText;
      if (removedItem && removedItem.title === productTitle) {
        enableAddToCartButton();
      }
    }

    function enableAddToCartButton() {
      const addCartBtn = document.querySelector('.add-cart');
      addCartBtn.disabled = false;
      addCartBtn.style.backgroundColor = '';
      addCartBtn.style.cursor = 'pointer';
      addCartBtn.innerText = 'Add to Cart';
    }

    function updateTotal() {
      const totalBox = document.getElementById('cartTotal');
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      totalBox.innerText = `Total: ₹${total}`;
    }

    // Checkout
    const checkoutBtn = document.getElementById('checkoutBtn');
    if (checkoutBtn) {
      checkoutBtn.addEventListener('click', () => {
        alert('Checkout system not implemented yet.');
      });

      document.getElementById("cartIcon").addEventListener("click", () => {
        loadCart();
        cartSidebar.classList.add('open');
      });


    }
  </script>
  <script src="js/otherpageNavbar.js"></script>

</body>

</html>